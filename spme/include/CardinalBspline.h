#ifndef __CardinalBSpline_h_wanghan__
#define __CardinalBSpline_h_wanghan__


template <typename VALUETYPE>
__device__ VALUETYPE
BSplineValue (const unsigned n,
	      const VALUETYPE u);
template <typename VALUETYPE>
__device__ VALUETYPE
BSplineDerivative (const unsigned n,
		   const VALUETYPE u);

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline02Value (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return VALUETYPE(1.0000000000000000e+00) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return VALUETYPE(-1.0000000000000000e+00) * u + VALUETYPE(2.0000000000000000e+00);
  default:
      return VALUETYPE(0.);
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline04Value (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return ((VALUETYPE(1.6666666666666666e-01) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return ((VALUETYPE(-5.0000000000000000e-01) * u + VALUETYPE(2.0000000000000000e+00)) * u + VALUETYPE(-2.0000000000000000e+00)) * u + VALUETYPE(6.6666666666666663e-01);
  case 2:
      return ((VALUETYPE(5.0000000000000000e-01) * u + VALUETYPE(-4.0000000000000000e+00)) * u + VALUETYPE(1.0000000000000000e+01)) * u + VALUETYPE(-7.3333333333333330e+00);
  case 3:
      return ((VALUETYPE(-1.6666666666666666e-01) * u + VALUETYPE(2.0000000000000000e+00)) * u + VALUETYPE(-8.0000000000000000e+00)) * u + VALUETYPE(1.0666666666666666e+01);
  default:
      return 0;
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline06Value (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return ((((VALUETYPE(8.3333333333333332e-03) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return ((((VALUETYPE(-4.1666666666666664e-02) * u + VALUETYPE(2.5000000000000000e-01)) * u + VALUETYPE(-5.0000000000000000e-01)) * u + VALUETYPE(5.0000000000000000e-01)) * u + VALUETYPE(-2.4999999999999997e-01)) * u + VALUETYPE(4.9999999999999996e-02);
  case 2:
      return ((((VALUETYPE(8.3333333333333343e-02) * u + VALUETYPE(-1.0000000000000000e+00)) * u + VALUETYPE(4.5000000000000000e+00)) * u + VALUETYPE(-9.5000000000000000e+00)) * u + VALUETYPE(9.7500000000000000e+00)) * u + VALUETYPE(-3.9499999999999997e+00);
  case 3:
      return ((((VALUETYPE(-8.3333333333333343e-02) * u + VALUETYPE(1.5000000000000000e+00)) * u + VALUETYPE(-1.0500000000000000e+01)) * u + VALUETYPE(3.5500000000000000e+01)) * u + VALUETYPE(-5.7750000000000000e+01)) * u + VALUETYPE(3.6549999999999997e+01);
  case 4:
      return ((((VALUETYPE(4.1666666666666664e-02) * u + VALUETYPE(-1.0000000000000000e+00)) * u + VALUETYPE(9.5000000000000000e+00)) * u + VALUETYPE(-4.4500000000000000e+01)) * u + VALUETYPE(1.0224999999999999e+02)) * u + VALUETYPE(-9.1449999999999989e+01);
  case 5:
      return ((((VALUETYPE(-8.3333333333333332e-03) * u + VALUETYPE(2.4999999999999997e-01)) * u + VALUETYPE(-3.0000000000000000e+00)) * u + VALUETYPE(1.7999999999999996e+01)) * u + VALUETYPE(-5.3999999999999986e+01)) * u + VALUETYPE(6.4799999999999997e+01);
  default:
      return 0;
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline08Value (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return ((((((VALUETYPE(1.9841269841269839e-04) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return ((((((VALUETYPE(-1.3888888888888887e-03) * u + VALUETYPE(1.1111111111111110e-02)) * u + VALUETYPE(-3.3333333333333326e-02)) * u + VALUETYPE(5.5555555555555552e-02)) * u + VALUETYPE(-5.5555555555555546e-02)) * u + VALUETYPE(3.3333333333333333e-02)) * u + VALUETYPE(-1.1111111111111108e-02)) * u + VALUETYPE(1.5873015873015871e-03);
  case 2:
      return ((((((VALUETYPE(4.1666666666666666e-03) * u + VALUETYPE(-6.6666666666666652e-02)) * u + VALUETYPE(4.3333333333333329e-01)) * u + VALUETYPE(-1.5000000000000000e+00)) * u + VALUETYPE(3.0555555555555554e+00)) * u + VALUETYPE(-3.6999999999999997e+00)) * u + VALUETYPE(2.4777777777777779e+00)) * u + VALUETYPE(-7.0952380952380956e-01);
  case 3:
      return ((((((VALUETYPE(-6.9444444444444441e-03) * u + VALUETYPE(1.6666666666666666e-01)) * u + VALUETYPE(-1.6666666666666665e+00)) * u + VALUETYPE(8.9999999999999982e+00)) * u + VALUETYPE(-2.8444444444444443e+01)) * u + VALUETYPE(5.3000000000000000e+01)) * u + VALUETYPE(-5.4222222222222229e+01)) * u + VALUETYPE(2.3590476190476192e+01);
  case 4:
      return ((((((VALUETYPE(6.9444444444444441e-03) * u + VALUETYPE(-2.2222222222222221e-01)) * u + VALUETYPE(3.0000000000000000e+00)) * u + VALUETYPE(-2.2111111111111114e+01)) * u + VALUETYPE(9.6000000000000000e+01)) * u + VALUETYPE(-2.4566666666666669e+02)) * u + VALUETYPE(3.4400000000000006e+02)) * u + VALUETYPE(-2.0396507936507936e+02);
  case 5:
      return ((((((VALUETYPE(-4.1666666666666666e-03) * u + VALUETYPE(1.6666666666666666e-01)) * u + VALUETYPE(-2.8333333333333330e+00)) * u + VALUETYPE(2.6499999999999996e+01)) * u + VALUETYPE(-1.4705555555555554e+02)) * u + VALUETYPE(4.8349999999999994e+02)) * u + VALUETYPE(-8.7127777777777783e+02)) * u + VALUETYPE(6.6409047619047635e+02);
  case 6:
      return ((((((VALUETYPE(1.3888888888888887e-03) * u + VALUETYPE(-6.6666666666666652e-02)) * u + VALUETYPE(1.3666666666666665e+00)) * u + VALUETYPE(-1.5499999999999996e+01)) * u + VALUETYPE(1.0494444444444443e+02)) * u + VALUETYPE(-4.2369999999999993e+02)) * u + VALUETYPE(9.4312222222222215e+02)) * u + VALUETYPE(-8.9110952380952358e+02);
  case 7:
      return ((((((VALUETYPE(-1.9841269841269839e-04) * u + VALUETYPE(1.1111111111111108e-02)) * u + VALUETYPE(-2.6666666666666661e-01)) * u + VALUETYPE(3.5555555555555554e+00)) * u + VALUETYPE(-2.8444444444444439e+01)) * u + VALUETYPE(1.3653333333333327e+02)) * u + VALUETYPE(-3.6408888888888879e+02)) * u + VALUETYPE(4.1610158730158719e+02);
  default:
      return 0;
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline10Value (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return ((((((((VALUETYPE(2.7557319223985884e-06) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return ((((((((VALUETYPE(-2.4801587301587295e-05) * u + VALUETYPE(2.4801587301587295e-04)) * u + VALUETYPE(-9.9206349206349179e-04)) * u + VALUETYPE(2.3148148148148143e-03)) * u + VALUETYPE(-3.4722222222222216e-03)) * u + VALUETYPE(3.4722222222222212e-03)) * u + VALUETYPE(-2.3148148148148147e-03)) * u + VALUETYPE(9.9206349206349201e-04)) * u + VALUETYPE(-2.4801587301587300e-04)) * u + VALUETYPE(2.7557319223985889e-05);
  case 2:
      return ((((((((VALUETYPE(9.9206349206349179e-05) * u + VALUETYPE(-1.9841269841269836e-03)) * u + VALUETYPE(1.6865079365079361e-02)) * u + VALUETYPE(-8.1018518518518517e-02)) * u + VALUETYPE(2.4652777777777773e-01)) * u + VALUETYPE(-4.9652777777777768e-01)) * u + VALUETYPE(6.6435185185185175e-01)) * u + VALUETYPE(-5.7043650793650780e-01)) * u + VALUETYPE(2.8546626984126983e-01)) * u + VALUETYPE(-6.3464506172839497e-02);
  case 3:
      return ((((((((VALUETYPE(-2.3148148148148144e-04) * u + VALUETYPE(6.9444444444444441e-03)) * u + VALUETYPE(-9.0277777777777762e-02)) * u + VALUETYPE(6.6898148148148140e-01)) * u + VALUETYPE(-3.1284722222222223e+00)) * u + VALUETYPE(9.6284722222222214e+00)) * u + VALUETYPE(-1.9585648148148149e+01)) * u + VALUETYPE(2.5465277777777779e+01)) * u + VALUETYPE(-1.9241319444444446e+01)) * u + VALUETYPE(6.4454640652557309e+00);
  case 4:
      return ((((((((VALUETYPE(3.4722222222222218e-04) * u + VALUETYPE(-1.3888888888888888e-02)) * u + VALUETYPE(2.4305555555555552e-01)) * u + VALUETYPE(-2.4421296296296298e+00)) * u + VALUETYPE(1.5538194444444443e+01)) * u + VALUETYPE(-6.5038194444444443e+01)) * u + VALUETYPE(1.7952546296296296e+02)) * u + VALUETYPE(-3.1586805555555554e+02)) * u + VALUETYPE(3.2209201388888886e+02)) * u + VALUETYPE(-1.4525823963844798e+02);
  case 5:
      return ((((((((VALUETYPE(-3.4722222222222218e-04) * u + VALUETYPE(1.7361111111111112e-02)) * u + VALUETYPE(-3.8194444444444442e-01)) * u + VALUETYPE(4.8495370370370372e+00)) * u + VALUETYPE(-3.9149305555555557e+01)) * u + VALUETYPE(2.0839930555555554e+02)) * u + VALUETYPE(-7.3193287037037021e+02)) * u + VALUETYPE(1.6372569444444443e+03)) * u + VALUETYPE(-2.1193142361111109e+03)) * u + VALUETYPE(1.2110785659171074e+03);
  case 6:
      return ((((((((VALUETYPE(2.3148148148148144e-04) * u + VALUETYPE(-1.3888888888888888e-02)) * u + VALUETYPE(3.6805555555555552e-01)) * u + VALUETYPE(-5.6504629629629628e+00)) * u + VALUETYPE(5.5350694444444443e+01)) * u + VALUETYPE(-3.5860069444444446e+02)) * u + VALUETYPE(1.5360671296296298e+03)) * u + VALUETYPE(-4.1947430555555557e+03)) * u + VALUETYPE(6.6286857638888887e+03)) * u + VALUETYPE(-4.6209214340828930e+03);
  case 7:
      return ((((((((VALUETYPE(-9.9206349206349179e-05) * u + VALUETYPE(6.9444444444444432e-03)) * u + VALUETYPE(-2.1527777777777773e-01)) * u + VALUETYPE(3.8773148148148140e+00)) * u + VALUETYPE(-4.4690972222222214e+01)) * u + VALUETYPE(3.4169097222222217e+02)) * u + VALUETYPE(-1.7319606481481478e+03)) * u + VALUETYPE(5.6093402777777774e+03)) * u + VALUETYPE(-1.0528460069444443e+04)) * u + VALUETYPE(8.7235253251763679e+03);
  case 8:
      return ((((((((VALUETYPE(2.4801587301587295e-05) * u + VALUETYPE(-1.9841269841269836e-03)) * u + VALUETYPE(7.0436507936507908e-02)) * u + VALUETYPE(-1.4560185185185182e+00)) * u + VALUETYPE(1.9309027777777775e+01)) * u + VALUETYPE(-1.7030902777777771e+02)) * u + VALUETYPE(9.9870601851851836e+02)) * u + VALUETYPE(-3.7529454365079359e+03)) * u + VALUETYPE(8.1961113591269823e+03)) * u + VALUETYPE(-7.9205381668871241e+03);
  case 9:
      return ((((((((VALUETYPE(-2.7557319223985884e-06) * u + VALUETYPE(2.4801587301587300e-04)) * u + VALUETYPE(-9.9206349206349166e-03)) * u + VALUETYPE(2.3148148148148145e-01)) * u + VALUETYPE(-3.4722222222222219e+00)) * u + VALUETYPE(3.4722222222222214e+01)) * u + VALUETYPE(-2.3148148148148144e+02)) * u + VALUETYPE(9.9206349206349182e+02)) * u + VALUETYPE(-2.4801587301587292e+03)) * u + VALUETYPE(2.7557319223985878e+03);
  default:
      return 0;
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline12Value (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return ((((((((((VALUETYPE(2.5052108385441714e-08) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return ((((((((((VALUETYPE(-2.7557319223985883e-07) * u + VALUETYPE(3.3068783068783062e-06)) * u + VALUETYPE(-1.6534391534391529e-05)) * u + VALUETYPE(4.9603174603174590e-05)) * u + VALUETYPE(-9.9206349206349179e-05)) * u + VALUETYPE(1.3888888888888886e-04)) * u + VALUETYPE(-1.3888888888888886e-04)) * u + VALUETYPE(9.9206349206349179e-05)) * u + VALUETYPE(-4.9603174603174583e-05)) * u + VALUETYPE(1.6534391534391529e-05)) * u + VALUETYPE(-3.3068783068783057e-06)) * u + VALUETYPE(3.0062530062530054e-07);
  case 2:
      return ((((((((((VALUETYPE(1.3778659611992942e-06) * u + VALUETYPE(-3.3068783068783057e-05)) * u + VALUETYPE(3.4722222222222213e-04)) * u + VALUETYPE(-2.1329365079365077e-03)) * u + VALUETYPE(8.6309523809523780e-03)) * u + VALUETYPE(-2.4305555555555549e-02)) * u + VALUETYPE(4.8749999999999988e-02)) * u + VALUETYPE(-6.9742063492063480e-02)) * u + VALUETYPE(6.9791666666666655e-02)) * u + VALUETYPE(-4.6544312169312166e-02)) * u + VALUETYPE(1.8621031746031740e-02)) * u + VALUETYPE(-3.3859427609427600e-03);
  case 3:
      return ((((((((((VALUETYPE(-4.1335978835978830e-06) * u + VALUETYPE(1.4880952380952380e-04)) * u + VALUETYPE(-2.3809523809523803e-03)) * u + VALUETYPE(2.2420634920634917e-02)) * u + VALUETYPE(-1.3869047619047620e-01)) * u + VALUETYPE(5.9444444444444433e-01)) * u + VALUETYPE(-1.8074999999999997e+00)) * u + VALUETYPE(3.9079365079365074e+00)) * u + VALUETYPE(-5.8967261904761887e+00)) * u + VALUETYPE(5.9199735449735442e+00)) * u + VALUETYPE(-3.5612896825396816e+00)) * u + VALUETYPE(9.7295334295334279e-01);
  case 4:
      return ((((((((((VALUETYPE(8.2671957671957661e-06) * u + VALUETYPE(-3.9682539682539683e-04)) * u + VALUETYPE(8.5317460317460309e-03)) * u + VALUETYPE(-1.0853174603174602e-01)) * u + VALUETYPE(9.0892857142857131e-01)) * u + VALUETYPE(-5.2722222222222221e+00)) * u + VALUETYPE(2.1659166666666664e+01)) * u + VALUETYPE(-6.3139682539682532e+01)) * u + VALUETYPE(1.2819851190476189e+02)) * u + VALUETYPE(-1.7287367724867721e+02)) * u + VALUETYPE(1.3947363095238092e+02)) * u + VALUETYPE(-5.1039745069745059e+01);
  case 5:
      return ((((((((((VALUETYPE(-1.1574074074074073e-05) * u + VALUETYPE(6.9444444444444447e-04)) * u + VALUETYPE(-1.8750000000000003e-02)) * u + VALUETYPE(3.0069444444444449e-01)) * u + VALUETYPE(-3.1833333333333336e+00)) * u + VALUETYPE(2.3373611111111110e+01)) * u + VALUETYPE(-1.2156999999999998e+02)) * u + VALUETYPE(4.4839305555555552e+02)) * u + VALUETYPE(-1.1506333333333332e+03)) * u + VALUETYPE(1.9585127314814813e+03)) * u + VALUETYPE(-1.9919127777777776e+03)) * u + VALUETYPE(9.1777225889850877e+02);
  case 6:
      return ((((((((((VALUETYPE(1.1574074074074073e-05) * u + VALUETYPE(-8.3333333333333339e-04)) * u + VALUETYPE(2.7083333333333334e-02)) * u + VALUETYPE(-5.2430555555555558e-01)) * u + VALUETYPE(6.7166666666666677e+00)) * u + VALUETYPE(-5.9786388888888887e+01)) * u + VALUETYPE(3.7738999999999999e+02)) * u + VALUETYPE(-1.6900069444444443e+03)) * u + VALUETYPE(5.2645666666666657e+03)) * u + VALUETYPE(-1.0871887268518520e+04)) * u + VALUETYPE(1.3404567222222220e+04)) * u + VALUETYPE(-7.4803077411014910e+03);
  case 7:
      return ((((((((((VALUETYPE(-8.2671957671957661e-06) * u + VALUETYPE(6.9444444444444447e-04)) * u + VALUETYPE(-2.6388888888888889e-02)) * u + VALUETYPE(5.9861111111111109e-01)) * u + VALUETYPE(-9.0041666666666664e+00)) * u + VALUETYPE(9.4277777777777786e+01)) * u + VALUETYPE(-7.0105916666666667e+02)) * u + VALUETYPE(3.7022388888888891e+03)) * u + VALUETYPE(-1.3608293750000003e+04)) * u + VALUETYPE(3.3164787037037036e+04)) * u + VALUETYPE(-4.8246776805555543e+04)) * u + VALUETYPE(3.1752365731120728e+04);
  case 8:
      return ((((((((((VALUETYPE(4.1335978835978830e-06) * u + VALUETYPE(-3.9682539682539677e-04)) * u + VALUETYPE(1.7261904761904760e-02)) * u + VALUETYPE(-4.4900793650793647e-01)) * u + VALUETYPE(7.7577380952380945e+00)) * u + VALUETYPE(-9.3455555555555549e+01)) * u + VALUETYPE(8.0080749999999989e+02)) * u + VALUETYPE(-4.8798563492063495e+03)) * u + VALUETYPE(2.0720087202380953e+04)) * u + VALUETYPE(-5.8377562169312165e+04)) * u + VALUETYPE(9.8220981924603184e+04)) * u + VALUETYPE(-7.4769640618085614e+04);
  case 9:
      return ((((((((((VALUETYPE(-1.3778659611992942e-06) * u + VALUETYPE(1.4880952380952380e-04)) * u + VALUETYPE(-7.2916666666666642e-03)) * u + VALUETYPE(2.1393849206349203e-01)) * u + VALUETYPE(-4.1752976190476181e+00)) * u + VALUETYPE(5.6900694444444440e+01)) * u + VALUETYPE(-5.5239874999999984e+02)) * u + VALUETYPE(3.8193266865079354e+03)) * u + VALUETYPE(-1.8426236458333333e+04)) * u + VALUETYPE(5.9061408812830683e+04)) * u + VALUETYPE(-1.1316916584325397e+05)) * u + VALUETYPE(9.8185934828342972e+04);
  case 10:
      return ((((((((((VALUETYPE(2.7557319223985883e-07) * u + VALUETYPE(-3.3068783068783064e-05)) * u + VALUETYPE(1.8022486772486768e-03)) * u + VALUETYPE(-5.8878968253968239e-02)) * u + VALUETYPE(1.2810515873015871e+00)) * u + VALUETYPE(-1.9488194444444442e+01)) * u + VALUETYPE(2.1149013888888885e+02)) * u + VALUETYPE(-1.6370225198412695e+03)) * u + VALUETYPE(8.8555095734126953e+03)) * u + VALUETYPE(-3.1877744626322747e+04)) * u + VALUETYPE(6.8709141035052889e+04)) * u + VALUETYPE(-6.7157980515572359e+04);
  case 11:
      return ((((((((((VALUETYPE(-2.5052108385441714e-08) * u + VALUETYPE(3.3068783068783070e-06)) * u + VALUETYPE(-1.9841269841269839e-04)) * u + VALUETYPE(7.1428571428571418e-03)) * u + VALUETYPE(-1.7142857142857140e-01)) * u + VALUETYPE(2.8799999999999999e+00)) * u + VALUETYPE(-3.4560000000000002e+01)) * u + VALUETYPE(2.9622857142857146e+02)) * u + VALUETYPE(-1.7773714285714284e+03)) * u + VALUETYPE(7.1094857142857127e+03)) * u + VALUETYPE(-1.7062765714285710e+04)) * u + VALUETYPE(1.8613926233766237e+04);
  default:
      return 0;
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline14Value (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return ((((((((((((VALUETYPE(1.6059043836821611e-10) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return ((((((((((((VALUETYPE(-2.0876756987868092e-09) * u + VALUETYPE(2.9227459783015334e-08)) * u + VALUETYPE(-1.7536475869809198e-07)) * u + VALUETYPE(6.4300411522633729e-07)) * u + VALUETYPE(-1.6075102880658432e-06)) * u + VALUETYPE(2.8935185185185180e-06)) * u + VALUETYPE(-3.8580246913580239e-06)) * u + VALUETYPE(3.8580246913580231e-06)) * u + VALUETYPE(-2.8935185185185180e-06)) * u + VALUETYPE(1.6075102880658432e-06)) * u + VALUETYPE(-6.4300411522633729e-07)) * u + VALUETYPE(1.7536475869809198e-07)) * u + VALUETYPE(-2.9227459783015327e-08)) * u + VALUETYPE(2.2482661371550251e-09);
  case 2:
      return ((((((((((((VALUETYPE(1.2526054192720857e-08) * u + VALUETYPE(-3.5072951739618395e-07)) * u + VALUETYPE(4.3841189674522995e-06)) * u + VALUETYPE(-3.2793209876543203e-05)) * u + VALUETYPE(1.6557355967078185e-04)) * u + VALUETYPE(-5.9895833333333307e-04)) * u + VALUETYPE(1.6010802469135794e-03)) * u + VALUETYPE(-3.2060185185185178e-03)) * u + VALUETYPE(4.8119212962962950e-03)) * u + VALUETYPE(-5.3481867283950608e-03)) * u + VALUETYPE(4.2791923868312738e-03)) * u + VALUETYPE(-2.3342803030303024e-03)) * u + VALUETYPE(7.7812266180321706e-04)) * u + VALUETYPE(-1.1971342700509361e-04);
  case 3:
      return ((((((((((((VALUETYPE(-4.5928865373309807e-08) * u + VALUETYPE(1.9290123456790120e-06)) * u + VALUETYPE(-3.6651234567901221e-05)) * u + VALUETYPE(4.1859567901234560e-04)) * u + VALUETYPE(-3.2198431069958844e-03)) * u + VALUETYPE(1.7682291666666662e-02)) * u + VALUETYPE(-7.1523919753086390e-02)) * u + VALUETYPE(2.1616898148148142e-01)) * u + VALUETYPE(-4.8878182870370357e-01)) * u + VALUETYPE(8.1730806327160455e-01)) * u + VALUETYPE(-9.8290830761316839e-01)) * u + VALUETYPE(8.0536458333333294e-01)) * u + VALUETYPE(-4.0307130915637840e-01)) * u + VALUETYPE(9.3076309300267598e-02);
  case 4:
      return ((((((((((((VALUETYPE(1.1482216343327453e-07) * u + VALUETYPE(-6.4300411522633735e-06)) * u + VALUETYPE(1.6396604938271602e-04)) * u + VALUETYPE(-2.5237911522633738e-03)) * u + VALUETYPE(2.6204025205761313e-02)) * u + VALUETYPE(-1.9416956018518516e-01)) * u + VALUETYPE(1.0583526234567899e+00)) * u + VALUETYPE(-4.3033371913580236e+00)) * u + VALUETYPE(1.3069736689814814e+01)) * u + VALUETYPE(-2.9312733088991767e+01)) * u + VALUETYPE(4.7225157536008219e+01)) * u + VALUETYPE(-5.1785252700617271e+01)) * u + VALUETYPE(3.4657340213477354e+01)) * u + VALUETYPE(-1.0694742620740881e+01);
  case 5:
      return ((((((((((((VALUETYPE(-2.0667989417989416e-07) * u + VALUETYPE(1.4467592592592590e-05)) * u + VALUETYPE(-4.6296296296296293e-04)) * u + VALUETYPE(8.9699074074074056e-03)) * u + VALUETYPE(-1.1746720679012343e-01)) * u + VALUETYPE(1.0988715277777774e+00)) * u + VALUETYPE(-7.5619212962962941e+00)) * u + VALUETYPE(3.8798032407407405e+01)) * u + VALUETYPE(-1.4856039930555551e+02)) * u + VALUETYPE(4.1965986689814804e+02)) * u + VALUETYPE(-8.5072004243827143e+02)) * u + VALUETYPE(1.1726854745370370e+03)) * u + VALUETYPE(-9.8573493248456759e+02)) * u + VALUETYPE(3.8176382380158418e+02);
  case 6:
      return ((((((((((((VALUETYPE(2.7557319223985888e-07) * u + VALUETYPE(-2.3148148148148150e-05)) * u + VALUETYPE(8.9120370370370373e-04)) * u + VALUETYPE(-2.0821759259259259e-02)) * u + VALUETYPE(3.2940779320987651e-01)) * u + VALUETYPE(-3.7273784722222221e+00)) * u + VALUETYPE(3.1048078703703702e+01)) * u + VALUETYPE(-1.9286196759259261e+02)) * u + VALUETYPE(8.9390960069444441e+02)) * u + VALUETYPE(-3.0552401331018509e+03)) * u + VALUETYPE(7.4890399575617275e+03)) * u + VALUETYPE(-1.2474194525462957e+04)) * u + VALUETYPE(1.2661145067515430e+04)) * u + VALUETYPE(-5.9167961761984143e+03);
  case 7:
      return ((((((((((((VALUETYPE(-2.7557319223985888e-07) * u + VALUETYPE(2.7006172839506174e-05)) * u + VALUETYPE(-1.2152777777777778e-03)) * u + VALUETYPE(3.3244598765432100e-02)) * u + VALUETYPE(-6.1675347222222232e-01)) * u + VALUETYPE(8.1942534722222238e+00)) * u + VALUETYPE(-8.0220486111111114e+01)) * u + VALUETYPE(5.8601798611111110e+02)) * u + VALUETYPE(-3.1952101562499993e+03)) * u + VALUETYPE(1.2846892255015428e+04)) * u + VALUETYPE(-3.7036930729166663e+04)) * u + VALUETYPE(7.2529931331018495e+04)) * u + VALUETYPE(-8.6510335098379612e+04)) * u + VALUETYPE(4.7483231605437373e+04);
  case 8:
      return ((((((((((((VALUETYPE(2.0667989417989416e-07) * u + VALUETYPE(-2.3148148148148150e-05)) * u + VALUETYPE(1.1921296296296296e-03)) * u + VALUETYPE(-3.7372685185185189e-02)) * u + VALUETYPE(7.9559220679012332e-01)) * u + VALUETYPE(-1.2143524305555555e+01)) * u + VALUETYPE(1.3671581018518521e+02)) * u + VALUETYPE(-1.1494723842592593e+03)) * u + VALUETYPE(7.2177320659722209e+03)) * u + VALUETYPE(-3.3432850954861111e+04)) * u + VALUETYPE(1.1105824754243827e+05)) * u + VALUETYPE(-2.5058682126157399e+05)) * u + VALUETYPE(3.4431200169174367e+05)) * u + VALUETYPE(-2.1763820641925390e+05);
  case 9:
      return ((((((((((((VALUETYPE(-1.1482216343327453e-07) * u + VALUETYPE(1.4467592592592591e-05)) * u + VALUETYPE(-8.3912037037037028e-04)) * u + VALUETYPE(2.9658564814814811e-02)) * u + VALUETYPE(-7.1261091820987643e-01)) * u + VALUETYPE(1.2289366319444442e+01)) * u + VALUETYPE(-1.5647887731481478e+02)) * u + VALUETYPE(1.4892798032407406e+03)) * u + VALUETYPE(-1.0593845199652778e+04)) * u + VALUETYPE(5.5625035373263905e+04)) * u + VALUETYPE(-2.0955014323881175e+05)) * u + VALUETYPE(5.3636104701967584e+05)) * u + VALUETYPE(-8.3610980073013122e+05)) * u + VALUETYPE(5.9957688756512117e+05);
  case 10:
      return ((((((((((((VALUETYPE(4.5928865373309807e-08) * u + VALUETYPE(-6.4300411522633735e-06)) * u + VALUETYPE(4.1473765432098762e-04)) * u + VALUETYPE(-1.6316229423868310e-02)) * u + VALUETYPE(4.3675893775720159e-01)) * u + VALUETYPE(-8.3992910879629612e+00)) * u + VALUETYPE(1.1936988811728392e+02)) * u + VALUETYPE(-1.2692078510802467e+03)) * u + VALUETYPE(1.0094812207754629e+04)) * u + VALUETYPE(-5.9311950223443913e+04)) * u + VALUETYPE(2.5019779914801949e+05)) * u + VALUETYPE(-7.1749697767168190e+05)) * u + VALUETYPE(1.2536535737554654e+06)) * u + VALUETYPE(-1.0079334005007225e+06);
  case 11:
      return ((((((((((((VALUETYPE(-1.2526054192720857e-08) * u + VALUETYPE(1.9290123456790120e-06)) * u + VALUETYPE(-1.3695987654320984e-04)) * u + VALUETYPE(5.9355709876543188e-03)) * u + VALUETYPE(-1.7516557355967072e-01)) * u + VALUETYPE(3.7168142361111101e+00)) * u + VALUETYPE(-5.8332989969135795e+01)) * u + VALUETYPE(6.8552380787037021e+02)) * u + VALUETYPE(-6.0317239785879619e+03)) * u + VALUETYPE(3.9239104248649681e+04)) * u + VALUETYPE(-1.8342684052919238e+05)) * u + VALUETYPE(5.8337694135995349e+05)) * u + VALUETYPE(-1.1312819444692000e+06)) * u + VALUETYPE(1.0100889610739948e+06);
  case 12:
      return ((((((((((((VALUETYPE(2.0876756987868092e-09) * u + VALUETYPE(-3.5072951739618400e-07)) * u + VALUETYPE(2.7181537598204258e-05)) * u + VALUETYPE(-1.2866512345679009e-03)) * u + VALUETYPE(4.1501093106995866e-02)) * u + VALUETYPE(-9.6318576388888855e-01)) * u + VALUETYPE(1.6547010030864193e+01)) * u + VALUETYPE(-2.1303619212962957e+02)) * u + VALUETYPE(2.0553160214120367e+03)) * u + VALUETYPE(-1.4674495751350305e+04)) * u + VALUETYPE(7.5358439470807600e+04)) * u + VALUETYPE(-2.6355670227640995e+05)) * u + VALUETYPE(5.6258534280352714e+05)) * u + VALUETYPE(-5.5348084256236884e+05);
  case 13:
      return ((((((((((((VALUETYPE(-1.6059043836821611e-10) * u + VALUETYPE(2.9227459783015334e-08)) * u + VALUETYPE(-2.4551066217732883e-06)) * u + VALUETYPE(1.2602880658436211e-04)) * u + VALUETYPE(-4.4110082304526744e-03)) * u + VALUETYPE(1.1115740740740740e-01)) * u + VALUETYPE(-2.0749382716049380e+00)) * u + VALUETYPE(2.9049135802469134e+01)) * u + VALUETYPE(-3.0501592592592596e+02)) * u + VALUETYPE(2.3723460905349798e+03)) * u + VALUETYPE(-1.3285138106995884e+04)) * u + VALUETYPE(5.0725072772166095e+04)) * u + VALUETYPE(-1.1835850313505424e+05)) * u + VALUETYPE(1.2746300337621223e+05);
  default:
      return 0;
  }
}













template <typename VALUETYPE>
__device__ VALUETYPE
BSpline02Derivative (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return VALUETYPE(1.);
  case 1:
      return VALUETYPE(-1.);
  default:
      return VALUETYPE(0.);
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline04Derivative (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return (VALUETYPE(5.0000000000000000e-01) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return (VALUETYPE(-1.5000000000000000e+00) * u + VALUETYPE(4.0000000000000000e+00)) * u + VALUETYPE(-2.0000000000000000e+00);
  case 2:
      return (VALUETYPE(1.5000000000000000e+00) * u + VALUETYPE(-8.0000000000000000e+00)) * u + VALUETYPE(1.0000000000000000e+01);
  case 3:
      return (VALUETYPE(-5.0000000000000000e-01) * u + VALUETYPE(4.0000000000000000e+00)) * u + VALUETYPE(-8.0000000000000000e+00);
  default:
      return VALUETYPE(0.);
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline06Derivative (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return (((VALUETYPE(4.1666666666666664e-02) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return (((VALUETYPE(-2.0833333333333331e-01) * u + VALUETYPE(1.0000000000000000e+00)) * u + VALUETYPE(-1.5000000000000000e+00)) * u + VALUETYPE(1.0000000000000000e+00)) * u + VALUETYPE(-2.4999999999999997e-01);
  case 2:
      return (((VALUETYPE(4.1666666666666674e-01) * u + VALUETYPE(-4.0000000000000000e+00)) * u + VALUETYPE(1.3500000000000000e+01)) * u + VALUETYPE(-1.9000000000000000e+01)) * u + VALUETYPE(9.7500000000000000e+00);
  case 3:
      return (((VALUETYPE(-4.1666666666666674e-01) * u + VALUETYPE(6.0000000000000000e+00)) * u + VALUETYPE(-3.1500000000000000e+01)) * u + VALUETYPE(7.1000000000000000e+01)) * u + VALUETYPE(-5.7750000000000000e+01);
  case 4:
      return (((VALUETYPE(2.0833333333333331e-01) * u + VALUETYPE(-4.0000000000000000e+00)) * u + VALUETYPE(2.8500000000000000e+01)) * u + VALUETYPE(-8.9000000000000000e+01)) * u + VALUETYPE(1.0224999999999999e+02);
  case 5:
      return (((VALUETYPE(-4.1666666666666664e-02) * u + VALUETYPE(9.9999999999999989e-01)) * u + VALUETYPE(-9.0000000000000000e+00)) * u + VALUETYPE(3.5999999999999993e+01)) * u + VALUETYPE(-5.3999999999999986e+01);
  default:
      return VALUETYPE(0.);
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline08Derivative (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return (((((VALUETYPE(1.3888888888888887e-03) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return (((((VALUETYPE(-9.7222222222222206e-03) * u + VALUETYPE(6.6666666666666652e-02)) * u + VALUETYPE(-1.6666666666666663e-01)) * u + VALUETYPE(2.2222222222222221e-01)) * u + VALUETYPE(-1.6666666666666663e-01)) * u + VALUETYPE(6.6666666666666666e-02)) * u + VALUETYPE(-1.1111111111111108e-02);
  case 2:
      return (((((VALUETYPE(2.9166666666666667e-02) * u + VALUETYPE(-3.9999999999999991e-01)) * u + VALUETYPE(2.1666666666666665e+00)) * u + VALUETYPE(-6.0000000000000000e+00)) * u + VALUETYPE(9.1666666666666661e+00)) * u + VALUETYPE(-7.3999999999999995e+00)) * u + VALUETYPE(2.4777777777777779e+00);
  case 3:
      return (((((VALUETYPE(-4.8611111111111105e-02) * u + VALUETYPE(1.0000000000000000e+00)) * u + VALUETYPE(-8.3333333333333321e+00)) * u + VALUETYPE(3.5999999999999993e+01)) * u + VALUETYPE(-8.5333333333333329e+01)) * u + VALUETYPE(1.0600000000000000e+02)) * u + VALUETYPE(-5.4222222222222229e+01);
  case 4:
      return (((((VALUETYPE(4.8611111111111105e-02) * u + VALUETYPE(-1.3333333333333333e+00)) * u + VALUETYPE(1.5000000000000000e+01)) * u + VALUETYPE(-8.8444444444444457e+01)) * u + VALUETYPE(2.8800000000000000e+02)) * u + VALUETYPE(-4.9133333333333337e+02)) * u + VALUETYPE(3.4400000000000006e+02);
  case 5:
      return (((((VALUETYPE(-2.9166666666666667e-02) * u + VALUETYPE(1.0000000000000000e+00)) * u + VALUETYPE(-1.4166666666666664e+01)) * u + VALUETYPE(1.0599999999999999e+02)) * u + VALUETYPE(-4.4116666666666663e+02)) * u + VALUETYPE(9.6699999999999989e+02)) * u + VALUETYPE(-8.7127777777777783e+02);
  case 6:
      return (((((VALUETYPE(9.7222222222222206e-03) * u + VALUETYPE(-3.9999999999999991e-01)) * u + VALUETYPE(6.8333333333333321e+00)) * u + VALUETYPE(-6.1999999999999986e+01)) * u + VALUETYPE(3.1483333333333326e+02)) * u + VALUETYPE(-8.4739999999999986e+02)) * u + VALUETYPE(9.4312222222222215e+02);
  case 7:
      return (((((VALUETYPE(-1.3888888888888887e-03) * u + VALUETYPE(6.6666666666666652e-02)) * u + VALUETYPE(-1.3333333333333330e+00)) * u + VALUETYPE(1.4222222222222221e+01)) * u + VALUETYPE(-8.5333333333333314e+01)) * u + VALUETYPE(2.7306666666666655e+02)) * u + VALUETYPE(-3.6408888888888879e+02);
  default:
      return VALUETYPE(0.);
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline10Derivative (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return (((((((VALUETYPE(2.4801587301587295e-05) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return (((((((VALUETYPE(-2.2321428571428565e-04) * u + VALUETYPE(1.9841269841269836e-03)) * u + VALUETYPE(-6.9444444444444423e-03)) * u + VALUETYPE(1.3888888888888885e-02)) * u + VALUETYPE(-1.7361111111111108e-02)) * u + VALUETYPE(1.3888888888888885e-02)) * u + VALUETYPE(-6.9444444444444441e-03)) * u + VALUETYPE(1.9841269841269840e-03)) * u + VALUETYPE(-2.4801587301587300e-04);
  case 2:
      return (((((((VALUETYPE(8.9285714285714261e-04) * u + VALUETYPE(-1.5873015873015869e-02)) * u + VALUETYPE(1.1805555555555552e-01)) * u + VALUETYPE(-4.8611111111111110e-01)) * u + VALUETYPE(1.2326388888888886e+00)) * u + VALUETYPE(-1.9861111111111107e+00)) * u + VALUETYPE(1.9930555555555554e+00)) * u + VALUETYPE(-1.1408730158730156e+00)) * u + VALUETYPE(2.8546626984126983e-01);
  case 3:
      return (((((((VALUETYPE(-2.0833333333333329e-03) * u + VALUETYPE(5.5555555555555552e-02)) * u + VALUETYPE(-6.3194444444444431e-01)) * u + VALUETYPE(4.0138888888888884e+00)) * u + VALUETYPE(-1.5642361111111111e+01)) * u + VALUETYPE(3.8513888888888886e+01)) * u + VALUETYPE(-5.8756944444444443e+01)) * u + VALUETYPE(5.0930555555555557e+01)) * u + VALUETYPE(-1.9241319444444446e+01);
  case 4:
      return (((((((VALUETYPE(3.1249999999999997e-03) * u + VALUETYPE(-1.1111111111111110e-01)) * u + VALUETYPE(1.7013888888888886e+00)) * u + VALUETYPE(-1.4652777777777779e+01)) * u + VALUETYPE(7.7690972222222214e+01)) * u + VALUETYPE(-2.6015277777777777e+02)) * u + VALUETYPE(5.3857638888888891e+02)) * u + VALUETYPE(-6.3173611111111109e+02)) * u + VALUETYPE(3.2209201388888886e+02);
  case 5:
      return (((((((VALUETYPE(-3.1249999999999997e-03) * u + VALUETYPE(1.3888888888888890e-01)) * u + VALUETYPE(-2.6736111111111107e+00)) * u + VALUETYPE(2.9097222222222221e+01)) * u + VALUETYPE(-1.9574652777777777e+02)) * u + VALUETYPE(8.3359722222222217e+02)) * u + VALUETYPE(-2.1957986111111104e+03)) * u + VALUETYPE(3.2745138888888887e+03)) * u + VALUETYPE(-2.1193142361111109e+03);
  case 6:
      return (((((((VALUETYPE(2.0833333333333329e-03) * u + VALUETYPE(-1.1111111111111110e-01)) * u + VALUETYPE(2.5763888888888888e+00)) * u + VALUETYPE(-3.3902777777777779e+01)) * u + VALUETYPE(2.7675347222222223e+02)) * u + VALUETYPE(-1.4344027777777778e+03)) * u + VALUETYPE(4.6082013888888896e+03)) * u + VALUETYPE(-8.3894861111111113e+03)) * u + VALUETYPE(6.6286857638888887e+03);
  case 7:
      return (((((((VALUETYPE(-8.9285714285714261e-04) * u + VALUETYPE(5.5555555555555546e-02)) * u + VALUETYPE(-1.5069444444444442e+00)) * u + VALUETYPE(2.3263888888888886e+01)) * u + VALUETYPE(-2.2345486111111109e+02)) * u + VALUETYPE(1.3667638888888887e+03)) * u + VALUETYPE(-5.1958819444444434e+03)) * u + VALUETYPE(1.1218680555555555e+04)) * u + VALUETYPE(-1.0528460069444443e+04);
  case 8:
      return (((((((VALUETYPE(2.2321428571428565e-04) * u + VALUETYPE(-1.5873015873015869e-02)) * u + VALUETYPE(4.9305555555555536e-01)) * u + VALUETYPE(-8.7361111111111089e+00)) * u + VALUETYPE(9.6545138888888872e+01)) * u + VALUETYPE(-6.8123611111111086e+02)) * u + VALUETYPE(2.9961180555555552e+03)) * u + VALUETYPE(-7.5058908730158719e+03)) * u + VALUETYPE(8.1961113591269823e+03);
  case 9:
      return (((((((VALUETYPE(-2.4801587301587295e-05) * u + VALUETYPE(1.9841269841269840e-03)) * u + VALUETYPE(-6.9444444444444420e-02)) * u + VALUETYPE(1.3888888888888888e+00)) * u + VALUETYPE(-1.7361111111111111e+01)) * u + VALUETYPE(1.3888888888888886e+02)) * u + VALUETYPE(-6.9444444444444434e+02)) * u + VALUETYPE(1.9841269841269836e+03)) * u + VALUETYPE(-2.4801587301587292e+03);
  default:
      return VALUETYPE(0.);
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline12Derivative (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return (((((((((VALUETYPE(2.7557319223985883e-07) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return (((((((((VALUETYPE(-3.0313051146384471e-06) * u + VALUETYPE(3.3068783068783064e-05)) * u + VALUETYPE(-1.4880952380952377e-04)) * u + VALUETYPE(3.9682539682539672e-04)) * u + VALUETYPE(-6.9444444444444425e-04)) * u + VALUETYPE(8.3333333333333317e-04)) * u + VALUETYPE(-6.9444444444444436e-04)) * u + VALUETYPE(3.9682539682539672e-04)) * u + VALUETYPE(-1.4880952380952374e-04)) * u + VALUETYPE(3.3068783068783057e-05)) * u + VALUETYPE(-3.3068783068783057e-06);
  case 4:
      return (((((((((VALUETYPE(9.0939153439153423e-05) * u + VALUETYPE(-3.9682539682539680e-03)) * u + VALUETYPE(7.6785714285714277e-02)) * u + VALUETYPE(-8.6825396825396817e-01)) * u + VALUETYPE(6.3624999999999989e+00)) * u + VALUETYPE(-3.1633333333333333e+01)) * u + VALUETYPE(1.0829583333333332e+02)) * u + VALUETYPE(-2.5255873015873013e+02)) * u + VALUETYPE(3.8459553571428569e+02)) * u + VALUETYPE(-3.4574735449735442e+02)) * u + VALUETYPE(1.3947363095238092e+02);
  case 5:
      return (((((((((VALUETYPE(-1.2731481481481480e-04) * u + VALUETYPE(6.9444444444444449e-03)) * u + VALUETYPE(-1.6875000000000001e-01)) * u + VALUETYPE(2.4055555555555559e+00)) * u + VALUETYPE(-2.2283333333333335e+01)) * u + VALUETYPE(1.4024166666666667e+02)) * u + VALUETYPE(-6.0784999999999991e+02)) * u + VALUETYPE(1.7935722222222221e+03)) * u + VALUETYPE(-3.4518999999999996e+03)) * u + VALUETYPE(3.9170254629629626e+03)) * u + VALUETYPE(-1.9919127777777776e+03);
  case 6:
      return (((((((((VALUETYPE(1.2731481481481480e-04) * u + VALUETYPE(-8.3333333333333332e-03)) * u + VALUETYPE(2.4375000000000002e-01)) * u + VALUETYPE(-4.1944444444444446e+00)) * u + VALUETYPE(4.7016666666666673e+01)) * u + VALUETYPE(-3.5871833333333331e+02)) * u + VALUETYPE(1.8869499999999998e+03)) * u + VALUETYPE(-6.7600277777777774e+03)) * u + VALUETYPE(1.5793699999999997e+04)) * u + VALUETYPE(-2.1743774537037039e+04)) * u + VALUETYPE(1.3404567222222220e+04);
  case 7:
      return (((((((((VALUETYPE(-9.0939153439153423e-05) * u + VALUETYPE(6.9444444444444449e-03)) * u + VALUETYPE(-2.3749999999999999e-01)) * u + VALUETYPE(4.7888888888888888e+00)) * u + VALUETYPE(-6.3029166666666669e+01)) * u + VALUETYPE(5.6566666666666674e+02)) * u + VALUETYPE(-3.5052958333333336e+03)) * u + VALUETYPE(1.4808955555555556e+04)) * u + VALUETYPE(-4.0824881250000006e+04)) * u + VALUETYPE(6.6329574074074073e+04)) * u + VALUETYPE(-4.8246776805555543e+04);
  case 8:
      return (((((((((VALUETYPE(4.5469576719576712e-05) * u + VALUETYPE(-3.9682539682539680e-03)) * u + VALUETYPE(1.5535714285714283e-01)) * u + VALUETYPE(-3.5920634920634917e+00)) * u + VALUETYPE(5.4304166666666660e+01)) * u + VALUETYPE(-5.6073333333333335e+02)) * u + VALUETYPE(4.0040374999999995e+03)) * u + VALUETYPE(-1.9519425396825398e+04)) * u + VALUETYPE(6.2160261607142864e+04)) * u + VALUETYPE(-1.1675512433862433e+05)) * u + VALUETYPE(9.8220981924603184e+04);
  case 9:
      return (((((((((VALUETYPE(-1.5156525573192237e-05) * u + VALUETYPE(1.4880952380952380e-03)) * u + VALUETYPE(-6.5624999999999975e-02)) * u + VALUETYPE(1.7115079365079362e+00)) * u + VALUETYPE(-2.9227083333333326e+01)) * u + VALUETYPE(3.4140416666666664e+02)) * u + VALUETYPE(-2.7619937499999992e+03)) * u + VALUETYPE(1.5277306746031742e+04)) * u + VALUETYPE(-5.5278709374999999e+04)) * u + VALUETYPE(1.1812281762566137e+05)) * u + VALUETYPE(-1.1316916584325397e+05);
  case 10:
      return (((((((((VALUETYPE(3.0313051146384471e-06) * u + VALUETYPE(-3.3068783068783067e-04)) * u + VALUETYPE(1.6220238095238093e-02)) * u + VALUETYPE(-4.7103174603174591e-01)) * u + VALUETYPE(8.9673611111111100e+00)) * u + VALUETYPE(-1.1692916666666665e+02)) * u + VALUETYPE(1.0574506944444443e+03)) * u + VALUETYPE(-6.5480900793650781e+03)) * u + VALUETYPE(2.6566528720238086e+04)) * u + VALUETYPE(-6.3755489252645493e+04)) * u + VALUETYPE(6.8709141035052889e+04);
  case 11:
      return (((((((((VALUETYPE(-2.7557319223985883e-07) * u + VALUETYPE(3.3068783068783071e-05)) * u + VALUETYPE(-1.7857142857142854e-03)) * u + VALUETYPE(5.7142857142857134e-02)) * u + VALUETYPE(-1.1999999999999997e+00)) * u + VALUETYPE(1.7280000000000001e+01)) * u + VALUETYPE(-1.7280000000000001e+02)) * u + VALUETYPE(1.1849142857142858e+03)) * u + VALUETYPE(-5.3321142857142850e+03)) * u + VALUETYPE(1.4218971428571425e+04)) * u + VALUETYPE(-1.7062765714285710e+04);
  default:
      return VALUETYPE(0.);
  }
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSpline14Derivative (const VALUETYPE u)
{
  switch (int(u)){
  case 0:
      return (((((((((((VALUETYPE(2.0876756987868092e-09) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00)) * u + VALUETYPE(0.0000000000000000e+00);
  case 1:
      return (((((((((((VALUETYPE(-2.7139784084228520e-08) * u + VALUETYPE(3.5072951739618400e-07)) * u + VALUETYPE(-1.9290123456790115e-06)) * u + VALUETYPE(6.4300411522633727e-06)) * u + VALUETYPE(-1.4467592592592588e-05)) * u + VALUETYPE(2.3148148148148144e-05)) * u + VALUETYPE(-2.7006172839506168e-05)) * u + VALUETYPE(2.3148148148148137e-05)) * u + VALUETYPE(-1.4467592592592590e-05)) * u + VALUETYPE(6.4300411522633727e-06)) * u + VALUETYPE(-1.9290123456790120e-06)) * u + VALUETYPE(3.5072951739618395e-07)) * u + VALUETYPE(-2.9227459783015327e-08);
  case 2:
      return (((((((((((VALUETYPE(1.6283870450537115e-07) * u + VALUETYPE(-4.2087542087542076e-06)) * u + VALUETYPE(4.8225308641975292e-05)) * u + VALUETYPE(-3.2793209876543205e-04)) * u + VALUETYPE(1.4901620370370368e-03)) * u + VALUETYPE(-4.7916666666666646e-03)) * u + VALUETYPE(1.1207561728395056e-02)) * u + VALUETYPE(-1.9236111111111107e-02)) * u + VALUETYPE(2.4059606481481477e-02)) * u + VALUETYPE(-2.1392746913580243e-02)) * u + VALUETYPE(1.2837577160493822e-02)) * u + VALUETYPE(-4.6685606060606049e-03)) * u + VALUETYPE(7.7812266180321706e-04);
  case 3:
      return (((((((((((VALUETYPE(-5.9707524985302747e-07) * u + VALUETYPE(2.3148148148148144e-05)) * u + VALUETYPE(-4.0316358024691345e-04)) * u + VALUETYPE(4.1859567901234556e-03)) * u + VALUETYPE(-2.8978587962962959e-02)) * u + VALUETYPE(1.4145833333333330e-01)) * u + VALUETYPE(-5.0066743827160476e-01)) * u + VALUETYPE(1.2970138888888885e+00)) * u + VALUETYPE(-2.4439091435185176e+00)) * u + VALUETYPE(3.2692322530864182e+00)) * u + VALUETYPE(-2.9487249228395052e+00)) * u + VALUETYPE(1.6107291666666659e+00)) * u + VALUETYPE(-4.0307130915637840e-01);
  case 4:
      return (((((((((((VALUETYPE(1.4926881246325689e-06) * u + VALUETYPE(-7.7160493827160479e-05)) * u + VALUETYPE(1.8036265432098762e-03)) * u + VALUETYPE(-2.5237911522633737e-02)) * u + VALUETYPE(2.3583622685185182e-01)) * u + VALUETYPE(-1.5533564814814813e+00)) * u + VALUETYPE(7.4084683641975300e+00)) * u + VALUETYPE(-2.5820023148148142e+01)) * u + VALUETYPE(6.5348683449074073e+01)) * u + VALUETYPE(-1.1725093235596707e+02)) * u + VALUETYPE(1.4167547260802465e+02)) * u + VALUETYPE(-1.0357050540123454e+02)) * u + VALUETYPE(3.4657340213477354e+01);
  case 5:
      return (((((((((((VALUETYPE(-2.6868386243386241e-06) * u + VALUETYPE(1.7361111111111109e-04)) * u + VALUETYPE(-5.0925925925925921e-03)) * u + VALUETYPE(8.9699074074074056e-02)) * u + VALUETYPE(-1.0572048611111109e+00)) * u + VALUETYPE(8.7909722222222193e+00)) * u + VALUETYPE(-5.2933449074074062e+01)) * u + VALUETYPE(2.3278819444444443e+02)) * u + VALUETYPE(-7.4280199652777753e+02)) * u + VALUETYPE(1.6786394675925922e+03)) * u + VALUETYPE(-2.5521601273148144e+03)) * u + VALUETYPE(2.3453709490740739e+03)) * u + VALUETYPE(-9.8573493248456759e+02);
  case 6:
      return (((((((((((VALUETYPE(3.5824514991181657e-06) * u + VALUETYPE(-2.7777777777777783e-04)) * u + VALUETYPE(9.8032407407407408e-03)) * u + VALUETYPE(-2.0821759259259259e-01)) * u + VALUETYPE(2.9646701388888888e+00)) * u + VALUETYPE(-2.9819027777777777e+01)) * u + VALUETYPE(2.1733655092592591e+02)) * u + VALUETYPE(-1.1571718055555557e+03)) * u + VALUETYPE(4.4695480034722223e+03)) * u + VALUETYPE(-1.2220960532407404e+04)) * u + VALUETYPE(2.2467119872685184e+04)) * u + VALUETYPE(-2.4948389050925914e+04)) * u + VALUETYPE(1.2661145067515430e+04);
  case 7:
      return (((((((((((VALUETYPE(-3.5824514991181657e-06) * u + VALUETYPE(3.2407407407407406e-04)) * u + VALUETYPE(-1.3368055555555557e-02)) * u + VALUETYPE(3.3244598765432098e-01)) * u + VALUETYPE(-5.5507812500000009e+00)) * u + VALUETYPE(6.5554027777777790e+01)) * u + VALUETYPE(-5.6154340277777783e+02)) * u + VALUETYPE(3.5161079166666668e+03)) * u + VALUETYPE(-1.5976050781249996e+04)) * u + VALUETYPE(5.1387569020061710e+04)) * u + VALUETYPE(-1.1111079218749999e+05)) * u + VALUETYPE(1.4505986266203699e+05)) * u + VALUETYPE(-8.6510335098379612e+04);
  case 8:
      return (((((((((((VALUETYPE(2.6868386243386241e-06) * u + VALUETYPE(-2.7777777777777783e-04)) * u + VALUETYPE(1.3113425925925926e-02)) * u + VALUETYPE(-3.7372685185185189e-01)) * u + VALUETYPE(7.1603298611111104e+00)) * u + VALUETYPE(-9.7148194444444442e+01)) * u + VALUETYPE(9.5701067129629644e+02)) * u + VALUETYPE(-6.8968343055555561e+03)) * u + VALUETYPE(3.6088660329861101e+04)) * u + VALUETYPE(-1.3373140381944444e+05)) * u + VALUETYPE(3.3317474262731482e+05)) * u + VALUETYPE(-5.0117364252314798e+05)) * u + VALUETYPE(3.4431200169174367e+05);
  case 9:
      return (((((((((((VALUETYPE(-1.4926881246325689e-06) * u + VALUETYPE(1.7361111111111109e-04)) * u + VALUETYPE(-9.2303240740740731e-03)) * u + VALUETYPE(2.9658564814814814e-01)) * u + VALUETYPE(-6.4134982638888882e+00)) * u + VALUETYPE(9.8314930555555534e+01)) * u + VALUETYPE(-1.0953521412037035e+03)) * u + VALUETYPE(8.9356788194444434e+03)) * u + VALUETYPE(-5.2969225998263893e+04)) * u + VALUETYPE(2.2250014149305562e+05)) * u + VALUETYPE(-6.2865042971643526e+05)) * u + VALUETYPE(1.0727220940393517e+06)) * u + VALUETYPE(-8.3610980073013122e+05);
  case 10:
      return (((((((((((VALUETYPE(5.9707524985302747e-07) * u + VALUETYPE(-7.7160493827160479e-05)) * u + VALUETYPE(4.5621141975308640e-03)) * u + VALUETYPE(-1.6316229423868311e-01)) * u + VALUETYPE(3.9308304398148142e+00)) * u + VALUETYPE(-6.7194328703703690e+01)) * u + VALUETYPE(8.3558921682098742e+02)) * u + VALUETYPE(-7.6152471064814799e+03)) * u + VALUETYPE(5.0474061038773143e+04)) * u + VALUETYPE(-2.3724780089377565e+05)) * u + VALUETYPE(7.5059339744405844e+05)) * u + VALUETYPE(-1.4349939553433638e+06)) * u + VALUETYPE(1.2536535737554654e+06);
  case 11:
      return (((((((((((VALUETYPE(-1.6283870450537115e-07) * u + VALUETYPE(2.3148148148148144e-05)) * u + VALUETYPE(-1.5065586419753083e-03)) * u + VALUETYPE(5.9355709876543192e-02)) * u + VALUETYPE(-1.5764901620370364e+00)) * u + VALUETYPE(2.9734513888888880e+01)) * u + VALUETYPE(-4.0833092978395058e+02)) * u + VALUETYPE(4.1131428472222215e+03)) * u + VALUETYPE(-3.0158619892939809e+04)) * u + VALUETYPE(1.5695641699459872e+05)) * u + VALUETYPE(-5.5028052158757718e+05)) * u + VALUETYPE(1.1667538827199070e+06)) * u + VALUETYPE(-1.1312819444692000e+06);
  case 12:
      return (((((((((((VALUETYPE(2.7139784084228520e-08) * u + VALUETYPE(-4.2087542087542076e-06)) * u + VALUETYPE(2.9899691358024682e-04)) * u + VALUETYPE(-1.2866512345679010e-02)) * u + VALUETYPE(3.7350983796296278e-01)) * u + VALUETYPE(-7.7054861111111084e+00)) * u + VALUETYPE(1.1582907021604936e+02)) * u + VALUETYPE(-1.2782171527777773e+03)) * u + VALUETYPE(1.0276580107060183e+04)) * u + VALUETYPE(-5.8697983005401220e+04)) * u + VALUETYPE(2.2607531841242278e+05)) * u + VALUETYPE(-5.2711340455281991e+05)) * u + VALUETYPE(5.6258534280352714e+05);
  case 13:
      return (((((((((((VALUETYPE(-2.0876756987868092e-09) * u + VALUETYPE(3.5072951739618400e-07)) * u + VALUETYPE(-2.7006172839506171e-05)) * u + VALUETYPE(1.2602880658436210e-03)) * u + VALUETYPE(-3.9699074074074067e-02)) * u + VALUETYPE(8.8925925925925919e-01)) * u + VALUETYPE(-1.4524567901234565e+01)) * u + VALUETYPE(1.7429481481481480e+02)) * u + VALUETYPE(-1.5250796296296298e+03)) * u + VALUETYPE(9.4893843621399192e+03)) * u + VALUETYPE(-3.9855414320987649e+04)) * u + VALUETYPE(1.0145014554433219e+05)) * u + VALUETYPE(-1.1835850313505424e+05);
  default:
      return VALUETYPE(0.);
  }
}






template <typename VALUETYPE>
__device__ VALUETYPE
BSplineValue (const unsigned n,
	      const VALUETYPE u)
{
  switch (n) {
  case 2:
      return BSpline02Value (u);
  case 4:
      return BSpline04Value (u);
  case 6:
      return BSpline06Value (u);
  case 8:
      return BSpline08Value (u);
  case 10:
      return BSpline10Value (u);
  case 12:
      return BSpline12Value (u);
  case 14:
      return BSpline14Value (u);
  default:
      return 0;
  }   
}

template <typename VALUETYPE>
__device__ VALUETYPE
BSplineDerivative (const unsigned n,
		   const VALUETYPE u)
{
  switch (n) {
  case 2:
      return BSpline02Derivative (u);
  case 4:
      return BSpline04Derivative (u);
  case 6:
      return BSpline06Derivative (u);
  case 8:
      return BSpline08Derivative (u);
  case 10:
      return BSpline10Derivative (u);
  case 12:
      return BSpline12Derivative (u);
  case 14:
      return BSpline14Derivative (u);
  default:
      return 0;
  }   
}



// __device__ VALUETYPE
// BSpline02Derivative (const VALUETYPE u)
// {
//   switch (int(u)){
//   case 0:
//       return VALUETYPE(1);
//       break;
//   case 1:
//       return -VALUETYPE(1);
//       break;
//   default:
//       return VALUETYPE(0);
//   }
// }

// __device__ VALUETYPE
// BSpline04Derivative (const VALUETYPE u)
// {
//   switch (int(u)){
//   case 0:
//       return VALUETYPE(1.) * u + VALUETYPE(0.);
//       break;
//   case 1:
//       return -VALUETYPE(2.) * u + VALUETYPE(3.);
//       break;
//   case 2:
//       return VALUETYPE(1.) * u + -VALUETYPE(3.);
//       break;
//   default:
//       return VALUETYPE(0.);
//   }
// }



#endif
